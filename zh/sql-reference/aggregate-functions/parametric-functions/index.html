<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-zh/sql-reference/aggregate-functions/parametric-functions">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KF1LLRTQ5Q"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KF1LLRTQ5Q",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="ClickHouse Docs" href="/opensearch.xml">
<script src="./src/js/analytics.js"></script><title data-rh="true">å‚æ•°èšåˆå‡½æ•° | ClickHouse Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://sturdy-adventure-06fed4eb.pages.github.io//zh/sql-reference/aggregate-functions/parametric-functions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="å‚æ•°èšåˆå‡½æ•° | ClickHouse Docs"><meta data-rh="true" name="description" content="aggregatefunctionsparametric}"><meta data-rh="true" property="og:description" content="aggregatefunctionsparametric}"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sturdy-adventure-06fed4eb.pages.github.io//zh/sql-reference/aggregate-functions/parametric-functions"><link data-rh="true" rel="alternate" href="https://sturdy-adventure-06fed4eb.pages.github.io//zh/sql-reference/aggregate-functions/parametric-functions" hreflang="en"><link data-rh="true" rel="alternate" href="https://sturdy-adventure-06fed4eb.pages.github.io//zh/sql-reference/aggregate-functions/parametric-functions" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d094a63e.css">
<link rel="preload" href="/assets/js/runtime~main.db9e59e5.js" as="script">
<link rel="preload" href="/assets/js/main.028d105f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">ClickHouse</b></a><a class="navbar__item navbar__link" href="/en/intro">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Language</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/intro">English</a></li><li><a class="dropdown__link" href="/ru">Russian</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh">Chinese</a></li></ul></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD sidebarWithHideableNavbar_d0QC"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_YUvz"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--dark_oUvU"><b>ClickHouse</b></a><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/">ä»€ä¹ˆæ˜¯ClickHouseï¼Ÿ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/ç®€ä»‹">ç®€ä»‹</a><button aria-label="Toggle the collapsible sidebar category &#x27;ç®€ä»‹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/getting-started/">å¿«é€Ÿä¸Šæ‰‹</a><button aria-label="Toggle the collapsible sidebar category &#x27;å¿«é€Ÿä¸Šæ‰‹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/interfaces/">æ¥å£</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ¥å£&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/å¼•æ“">å¼•æ“</a><button aria-label="Toggle the collapsible sidebar category &#x27;å¼•æ“&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/sql-reference/">SQLå‚è€ƒ</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQLå‚è€ƒ&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/statements/">SQL è¯­å¥</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL è¯­å¥&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/sql-reference/syntax">SQLè¯­æ³•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/sql-reference/distributed-ddl">Distributed DDL</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/functions/">å‡½æ•°</a><button aria-label="Toggle the collapsible sidebar category &#x27;å‡½æ•°&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/sql-reference/aggregate-functions/">èšåˆå‡½æ•°</a><button aria-label="Toggle the collapsible sidebar category &#x27;èšåˆå‡½æ•°&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/aggregate-functions/reference/">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/sql-reference/aggregate-functions/combinators">èšåˆå‡½æ•°ç»„åˆå™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/sql-reference/aggregate-functions/parametric-functions">å‚æ•°èšåˆå‡½æ•°</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/table-functions/">è¡¨å‡½æ•°</a><button aria-label="Toggle the collapsible sidebar category &#x27;è¡¨å‡½æ•°&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/dictionaries/">å­—å…¸</a><button aria-label="Toggle the collapsible sidebar category &#x27;å­—å…¸&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/data-types/">æ•°æ®ç±»å‹</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ•°æ®ç±»å‹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/sql-reference/ansi">ANSIå…¼å®¹æ€§</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/sql-reference/window-functions/">Window Functions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/sql-reference/operators/">æ“ä½œç¬¦</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ“ä½œç¬¦&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/guides/">ClickHouseæŒ‡å—</a><button aria-label="Toggle the collapsible sidebar category &#x27;ClickHouseæŒ‡å—&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/operations/">æ“ä½œ</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ“ä½œ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/commercial/">å•†ä¸šæ”¯æŒ</a><button aria-label="Toggle the collapsible sidebar category &#x27;å•†ä¸šæ”¯æŒ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/faq/">F.A.Q.</a><button aria-label="Toggle the collapsible sidebar category &#x27;F.A.Q.&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/whats-new/">ClickHouseäº‹è¿¹</a><button aria-label="Toggle the collapsible sidebar category &#x27;ClickHouseäº‹è¿¹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/changelog/">å˜æ›´æ—¥å¿—</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/development/">ClickHouse å¼€å‘</a><button aria-label="Toggle the collapsible sidebar category &#x27;ClickHouse å¼€å‘&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">ğŸ </a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/sql-reference/"><span itemprop="name">SQLå‚è€ƒ</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/sql-reference/aggregate-functions/"><span itemprop="name">èšåˆå‡½æ•°</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">å‚æ•°èšåˆå‡½æ•°</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>å‚æ•°èšåˆå‡½æ•°</h1><p>ä¸€äº›èšåˆå‡½æ•°ä¸ä»…å¯ä»¥æ¥å—å‚æ•°åˆ—ï¼ˆç”¨äºå‹ç¼©ï¼‰ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å¸¸é‡çš„åˆå§‹åŒ–å‚æ•°ã€‚è¿™ç§è¯­æ³•æ˜¯æ¥å—ä¸¤ä¸ªæ‹¬å·çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ•°åˆå§‹åŒ–å‚æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯å…¥å‚ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="histogram">histogram<a class="hash-link" href="#histogram" title="Direct link to heading">â€‹</a></h2><p>è®¡ç®—è‡ªé€‚åº”ç›´æ–¹å›¾ã€‚ å®ƒä¸èƒ½ä¿è¯ç²¾ç¡®çš„ç»“æœã€‚</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">number_of_bins</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">values</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>è¯¥å‡½æ•°ä½¿ç”¨ <a href="http://jmlr.org/papers/volume11/ben-haim10a/ben-haim10a.pdf" target="_blank" rel="noopener noreferrer">æµå¼å¹¶è¡Œå†³ç­–æ ‘ç®—æ³•</a>. å½“æ–°æ•°æ®è¾“å…¥å‡½æ•°æ—¶ï¼Œhistå›¾åˆ†åŒºçš„è¾¹ç•Œå°†è¢«è°ƒæ•´ã€‚ åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œç®±çš„å®½åº¦ä¸ç›¸ç­‰ã€‚</p><p><strong>å‚æ•°</strong></p><p><code>number_of_bins</code> â€” ç›´æ–¹å›¾binä¸ªæ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè‡ªåŠ¨è®¡ç®—binçš„æ•°é‡ï¼Œè€Œä¸”ä¼šå°½é‡ä½¿ç”¨æŒ‡å®šå€¼ï¼Œå¦‚æœæ— æ³•åšåˆ°ï¼Œé‚£å°±ä½¿ç”¨æ›´å°çš„binä¸ªæ•°ã€‚</p><p><code>values</code> â€” <a href="/zh/sql-reference/syntax#syntax-expressions">è¡¨è¾¾å¼</a> è¾“å…¥å€¼ã€‚</p><p><strong>è¿”å›å€¼</strong></p><ul><li><p><a href="/zh/sql-reference/data-types/array">Array</a> çš„ <a href="/zh/sql-reference/data-types/tuple">Tuples</a> å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">```</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[(lower_1, upper_1, height_1), ... (lower_N, upper_N, height_N)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">```</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">- `lower` â€” binçš„ä¸‹è¾¹ç•Œã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">- `upper` â€” binçš„ä¸Šè¾¹ç•Œã€‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">- `height` â€” binçš„è®¡ç®—æƒé‡ã€‚</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><p><strong>ç¤ºä¾‹</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">number </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">numbers</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€histogram(5)(plus(number, 1))â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ [(1,4.5,4),(4.5,8.5,4),(8.5,12.75,4.125),(12.75,17,4.625),(17,20,3.25)] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>æ‚¨å¯ä»¥ä½¿ç”¨ <a href="/zh/sql-reference/functions/other-functions#function-bar">bar</a> åŠŸèƒ½ï¼Œä¾‹å¦‚:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> hist</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arrayJoin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token number" style="color:rgb(9, 134, 88)">.3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">numbers</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€heightâ”€â”¬â”€barâ”€â”€â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  2.125 â”‚ â–ˆâ–‹    â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   3.25 â”‚ â–ˆâ–ˆâ–Œ   â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  5.625 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ– â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  5.625 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ– â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  3.375 â”‚ â–ˆâ–ˆâ–Œ   â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥è®°ä½æ‚¨ä¸çŸ¥é“ç›´æ–¹å›¾binè¾¹ç•Œã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="function-sequencematch">sequenceMatch(pattern)(timestamp, cond1, cond2, â€¦)<a class="hash-link" href="#function-sequencematch" title="Direct link to heading">â€‹</a></h2><p>æ£€æŸ¥åºåˆ—æ˜¯å¦åŒ…å«ä¸æ¨¡å¼åŒ¹é…çš„äº‹ä»¶é“¾ã€‚</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>!!! warning &quot;è­¦å‘Š&quot;
åœ¨åŒä¸€ç§’é’Ÿå‘ç”Ÿçš„äº‹ä»¶å¯èƒ½ä»¥æœªå®šä¹‰çš„é¡ºåºæ’åˆ—åœ¨åºåˆ—ä¸­ï¼Œå½±å“ç»“æœã€‚</p><p><strong>å‚æ•°</strong></p><ul><li><p><code>pattern</code> â€” æ¨¡å¼å­—ç¬¦ä¸²ã€‚ å‚è€ƒ <a href="#sequence-function-pattern-syntax">æ¨¡å¼è¯­æ³•</a>.</p></li><li><p><code>timestamp</code> â€” åŒ…å«æ—¶é—´çš„åˆ—ã€‚å…¸å‹çš„æ—¶é—´ç±»å‹æ˜¯ï¼š <code>Date</code> å’Œ <code>DateTime</code>ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä»»ä½•æ”¯æŒçš„ <a href="/zh/sql-reference/data-types/int-uint">UInt</a> æ•°æ®ç±»å‹ã€‚</p></li><li><p><code>cond1</code>, <code>cond2</code> â€” äº‹ä»¶é“¾çš„çº¦æŸæ¡ä»¶ã€‚ æ•°æ®ç±»å‹æ˜¯ï¼š <code>UInt8</code>ã€‚ æœ€å¤šå¯ä»¥ä¼ é€’32ä¸ªæ¡ä»¶å‚æ•°ã€‚ è¯¥å‡½æ•°åªè€ƒè™‘è¿™äº›æ¡ä»¶ä¸­æè¿°çš„äº‹ä»¶ã€‚ å¦‚æœåºåˆ—åŒ…å«æœªåœ¨æ¡ä»¶ä¸­æè¿°çš„æ•°æ®ï¼Œåˆ™å‡½æ•°å°†è·³è¿‡è¿™äº›æ•°æ®ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><ul><li>1ï¼Œå¦‚æœæ¨¡å¼åŒ¹é…ã€‚</li><li>0ï¼Œå¦‚æœæ¨¡å¼ä¸åŒ¹é…ã€‚</li></ul><p>ç±»å‹: <code>UInt8</code>.</p><a name="sequence-function-pattern-syntax"></a>**æ¨¡å¼è¯­æ³•**<ul><li><p><code>(?N)</code> â€” åœ¨ä½ç½®<code>N</code>åŒ¹é…æ¡ä»¶å‚æ•°ã€‚ æ¡ä»¶åœ¨ç¼–å· <code>[1, 32]</code> èŒƒå›´ã€‚ ä¾‹å¦‚, <code>(?1)</code> åŒ¹é…ä¼ é€’ç»™ <code>cond1</code> å‚æ•°ã€‚</p></li><li><p><code>.*</code> â€” åŒ¹é…ä»»ä½•äº‹ä»¶çš„æ•°å­—ã€‚ ä¸éœ€è¦æ¡ä»¶å‚æ•°æ¥åŒ¹é…è¿™ä¸ªæ¨¡å¼ã€‚</p></li><li><p><code>(?t operator value)</code> â€” åˆ†å¼€ä¸¤ä¸ªäº‹ä»¶çš„æ—¶é—´ã€‚ ä¾‹å¦‚ï¼š <code>(?1)(?t&gt;1800)(?2)</code> åŒ¹é…å½¼æ­¤å‘ç”Ÿè¶…è¿‡1800ç§’çš„äº‹ä»¶ã€‚ è¿™äº›äº‹ä»¶ä¹‹é—´å¯ä»¥å­˜åœ¨ä»»æ„æ•°é‡çš„ä»»ä½•äº‹ä»¶ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ <code>&gt;=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>  è¿ç®—ç¬¦ã€‚</p></li></ul><p><strong>ä¾‹</strong></p><p>è€ƒè™‘åœ¨æ•°æ® <code>t</code> è¡¨:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€timeâ”€â”¬â”€numberâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    1 â”‚      1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    2 â”‚      3 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    3 â”‚      2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>æ‰§è¡ŒæŸ¥è¯¢:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1)(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€sequenceMatch(&#x27;(?1)(?2)&#x27;)(time, equals(number, 1), equals(number, 2))â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚                                                                     1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>è¯¥å‡½æ•°æ‰¾åˆ°äº†æ•°å­—2è·Ÿéšæ•°å­—1çš„äº‹ä»¶é“¾ã€‚ å®ƒè·³è¿‡äº†å®ƒä»¬ä¹‹é—´çš„æ•°å­—3ï¼Œå› ä¸ºè¯¥æ•°å­—æ²¡æœ‰è¢«æè¿°ä¸ºäº‹ä»¶ã€‚ å¦‚æœæˆ‘ä»¬æƒ³åœ¨æœç´¢ç¤ºä¾‹ä¸­ç»™å‡ºçš„äº‹ä»¶é“¾æ—¶è€ƒè™‘è¿™ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬åº”è¯¥ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªæ¡ä»¶ã€‚</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1)(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€sequenceMatch(&#x27;(?1)(?2)&#x27;)(time, equals(number, 1), equals(number, 2), equals(number, 3))â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚                                                                                        0 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‡½æ•°æ‰¾ä¸åˆ°ä¸æ¨¡å¼åŒ¹é…çš„äº‹ä»¶é“¾ï¼Œå› ä¸ºæ•°å­—3çš„äº‹ä»¶å‘ç”Ÿåœ¨1å’Œ2ä¹‹é—´ã€‚ å¦‚æœåœ¨ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ£€æŸ¥äº†æ•°å­—4çš„æ¡ä»¶ï¼Œåˆ™åºåˆ—å°†ä¸æ¨¡å¼åŒ¹é…ã€‚</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1)(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€sequenceMatch(&#x27;(?1)(?2)&#x27;)(time, equals(number, 1), equals(number, 2), equals(number, 4))â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚                                                                                        1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>å¦è¯·å‚é˜…</strong></p><ul><li><a href="#function-sequencecount">sequenceCount</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="function-sequencecount">sequenceCount(pattern)(time, cond1, cond2, â€¦)<a class="hash-link" href="#function-sequencecount" title="Direct link to heading">â€‹</a></h2><p>è®¡ç®—ä¸æ¨¡å¼åŒ¹é…çš„äº‹ä»¶é“¾çš„æ•°é‡ã€‚è¯¥å‡½æ•°æœç´¢ä¸é‡å çš„äº‹ä»¶é“¾ã€‚å½“å‰é“¾åŒ¹é…åï¼Œå®ƒå¼€å§‹æœç´¢ä¸‹ä¸€ä¸ªé“¾ã€‚</p><p>!!! warning &quot;è­¦å‘Š&quot;
åœ¨åŒä¸€ç§’é’Ÿå‘ç”Ÿçš„äº‹ä»¶å¯èƒ½ä»¥æœªå®šä¹‰çš„é¡ºåºæ’åˆ—åœ¨åºåˆ—ä¸­ï¼Œå½±å“ç»“æœã€‚</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">sequenceCount</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>å‚æ•°</strong></p><ul><li><p><code>pattern</code> â€” æ¨¡å¼å­—ç¬¦ä¸²ã€‚ å‚è€ƒï¼š<a href="#sequence-function-pattern-syntax">æ¨¡å¼è¯­æ³•</a>.</p></li><li><p><code>timestamp</code> â€” åŒ…å«æ—¶é—´çš„åˆ—ã€‚å…¸å‹çš„æ—¶é—´ç±»å‹æ˜¯ï¼š <code>Date</code> å’Œ <code>DateTime</code>ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä»»ä½•æ”¯æŒçš„ <a href="/zh/sql-reference/data-types/int-uint">UInt</a> æ•°æ®ç±»å‹ã€‚</p></li><li><p><code>cond1</code>, <code>cond2</code> â€” äº‹ä»¶é“¾çš„çº¦æŸæ¡ä»¶ã€‚ æ•°æ®ç±»å‹æ˜¯ï¼š <code>UInt8</code>ã€‚ æœ€å¤šå¯ä»¥ä¼ é€’32ä¸ªæ¡ä»¶å‚æ•°ã€‚è¯¥å‡½æ•°åªè€ƒè™‘è¿™äº›æ¡ä»¶ä¸­æè¿°çš„äº‹ä»¶ã€‚ å¦‚æœåºåˆ—åŒ…å«æœªåœ¨æ¡ä»¶ä¸­æè¿°çš„æ•°æ®ï¼Œåˆ™å‡½æ•°å°†è·³è¿‡è¿™äº›æ•°æ®ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><ul><li>åŒ¹é…çš„éé‡å äº‹ä»¶é“¾æ•°ã€‚</li></ul><p>ç±»å‹: <code>UInt64</code>.</p><p><strong>ç¤ºä¾‹</strong></p><p>è€ƒè™‘åœ¨æ•°æ® <code>t</code> è¡¨:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€timeâ”€â”¬â”€numberâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    1 â”‚      1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    2 â”‚      3 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    3 â”‚      2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    4 â”‚      1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    5 â”‚      3 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚    6 â”‚      2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>è®¡ç®—æ•°å­—2åœ¨æ•°å­—1ä¹‹åå‡ºç°çš„æ¬¡æ•°ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä»»ä½•å…¶ä»–æ•°å­—:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceCount</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1).*(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€sequenceCount(&#x27;(?1).*(?2)&#x27;)(time, equals(number, 1), equals(number, 2))â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚                                                                       2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>å¦è¯·å‚é˜…</strong></p><ul><li><a href="#function-sequencematch">sequenceMatch</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="windowfunnel">windowFunnel<a class="hash-link" href="#windowfunnel" title="Direct link to heading">â€‹</a></h2><p>æœç´¢æ»‘åŠ¨æ—¶é—´çª—ä¸­çš„äº‹ä»¶é“¾ï¼Œå¹¶è®¡ç®—ä»é“¾ä¸­å‘ç”Ÿçš„æœ€å¤§äº‹ä»¶æ•°ã€‚</p><p>è¯¥å‡½æ•°é‡‡ç”¨å¦‚ä¸‹ç®—æ³•ï¼š</p><ul><li><p>è¯¥å‡½æ•°æœç´¢è§¦å‘é“¾ä¸­çš„ç¬¬ä¸€ä¸ªæ¡ä»¶å¹¶å°†äº‹ä»¶è®¡æ•°å™¨è®¾ç½®ä¸º1ã€‚ è¿™æ˜¯æ»‘åŠ¨çª—å£å¯åŠ¨çš„æ—¶åˆ»ã€‚</p></li><li><p>å¦‚æœæ¥è‡ªé“¾çš„äº‹ä»¶åœ¨çª—å£å†…é¡ºåºå‘ç”Ÿï¼Œåˆ™è®¡æ•°å™¨å°†é€’å¢ã€‚ å¦‚æœäº‹ä»¶åºåˆ—ä¸­æ–­ï¼Œåˆ™è®¡æ•°å™¨ä¸å†å¢åŠ ã€‚</p></li><li><p>å¦‚æœæ•°æ®åœ¨ä¸åŒçš„å®Œæˆç‚¹å…·æœ‰å¤šä¸ªäº‹ä»¶é“¾ï¼Œåˆ™è¯¥å‡½æ•°å°†ä»…è¾“å‡ºæœ€é•¿é“¾çš„å¤§å°ã€‚</p></li></ul><p><strong>è¯­æ³•</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">windowFunnel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">mode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">mode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> condN</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>å‚æ•°</strong></p><ul><li><code>window</code> â€” æ»‘åŠ¨çª—æˆ·çš„å¤§å°ï¼Œè¡¨ç¤ºäº‹ä»¶é“¾ä¸­ç¬¬ä¸€ä¸ªäº‹ä»¶å’Œæœ€åä¸€ä¸ªäº‹ä»¶çš„æœ€å¤§é—´éš”ã€‚ å•ä½å–å†³äº<code>timestamp </code>ã€‚ç”¨è¡¨è¾¾å¼æ¥è¡¨ç¤ºåˆ™æ˜¯ï¼š<code>timestamp of cond1 &lt;= timestamp of cond2 &lt;= ... &lt;= timestamp of condN &lt;= timestamp of cond1 + window</code>ã€‚</li><li><code>mode</code> - è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ã€‚<ul><li><code>&#x27;strict_deduplication&#x27;</code> - å¦‚æœäº‹ä»¶é“¾ä¸­å‡ºç°ç›¸åŒçš„æ¡ä»¶ï¼Œåˆ™ä¼šåœæ­¢è¿›ä¸€æ­¥æœç´¢ã€‚</li><li><code>&#x27;strict_order&#x27;</code> - ä¸å…è®¸å…¶ä»–äº‹ä»¶çš„ä»‹å…¥ã€‚ ä¾‹å¦‚ï¼šåœ¨<code>A-&gt;B-&gt;D-&gt;C</code>çš„æƒ…å†µä¸‹ï¼Œå®ƒåœ¨<code>D</code>åœæ­¢ç»§ç»­æœç´¢<code>A-&gt;B-&gt;C</code>ï¼Œæœ€å¤§äº‹ä»¶æ•°ä¸º2ã€‚</li><li><code>&#x27;strict_increase&#x27;</code> - äº‹ä»¶é“¾ä¸­çš„æ—¶é—´æˆ³å¿…é¡»ä¸¥æ ¼ä¸Šå‡ã€‚</li></ul></li><li><code>timestamp</code> â€” åŒ…å«æ—¶é—´æˆ³çš„åˆ—ã€‚ æ•°æ®ç±»å‹æ”¯æŒï¼š <a href="/zh/sql-reference/data-types/date">æ—¥æœŸ</a>, <a href="/zh/sql-reference/data-types/datetime#data_type-datetime">æ—¥æœŸæ—¶é—´</a> å’Œå…¶ä»–æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼ˆè¯·æ³¨æ„ï¼Œå³ä½¿æ—¶é—´æˆ³æ”¯æŒ <code>UInt64</code> ç±»å‹ï¼Œå®ƒçš„å€¼ä¹Ÿä¸èƒ½è¶…è¿‡Int64æœ€å¤§å€¼ï¼Œå³2^63-1ï¼‰ã€‚</li><li><code>cond</code> â€” äº‹ä»¶é“¾çš„çº¦æŸæ¡ä»¶ã€‚ <a href="/zh/sql-reference/data-types/int-uint">UInt8</a> ç±»å‹ã€‚</li></ul><p><strong>è¿”å›å€¼</strong></p><p>æ»‘åŠ¨æ—¶é—´çª—å£å†…è¿ç»­è§¦å‘æ¡ä»¶é“¾çš„æœ€å¤§æ•°ç›®ã€‚
å¯¹é€‰æ‹©ä¸­çš„æ‰€æœ‰é“¾è¿›è¡Œäº†åˆ†æã€‚</p><p>ç±»å‹: <code>Integer</code>.</p><p><strong>ç¤ºä¾‹</strong></p><p>ç¡®å®šè®¾å®šçš„æ—¶é—´æ®µæ˜¯å¦è¶³ä»¥è®©ç”¨æˆ·é€‰æ‹©æ‰‹æœºå¹¶åœ¨åœ¨çº¿å•†åº—ä¸­è´­ä¹°ä¸¤æ¬¡ã€‚</p><p>è®¾ç½®ä»¥ä¸‹äº‹ä»¶é“¾:</p><ol><li>ç”¨æˆ·ç™»å½•åˆ°å…¶åœ¨åº”ç”¨å•†åº—ä¸­çš„å¸æˆ· (<code>eventID = 1003</code>).</li><li>ç”¨æˆ·æœç´¢æ‰‹æœº (<code>eventID = 1007, product = &#x27;phone&#x27;</code>).</li><li>ç”¨æˆ·ä¸‹äº†è®¢å• (<code>eventID = 1009</code>).</li><li>ç”¨æˆ·å†æ¬¡ä¸‹è®¢å• (<code>eventID = 1010</code>).</li></ol><p>è¾“å…¥è¡¨:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€event_dateâ”€â”¬â”€user_idâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€timestampâ”€â”¬â”€eventIDâ”€â”¬â”€productâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2019-01-28 â”‚       1 â”‚ 2019-01-29 10:00:00 â”‚    1003 â”‚ phone   â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€event_dateâ”€â”¬â”€user_idâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€timestampâ”€â”¬â”€eventIDâ”€â”¬â”€productâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2019-01-31 â”‚       1 â”‚ 2019-01-31 09:00:00 â”‚    1007 â”‚ phone   â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€event_dateâ”€â”¬â”€user_idâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€timestampâ”€â”¬â”€eventIDâ”€â”¬â”€productâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2019-01-30 â”‚       1 â”‚ 2019-01-30 08:00:00 â”‚    1009 â”‚ phone   â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€event_dateâ”€â”¬â”€user_idâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€timestampâ”€â”¬â”€eventIDâ”€â”¬â”€productâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2019-02-01 â”‚       1 â”‚ 2019-02-01 08:00:00 â”‚    1010 â”‚ phone   â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>äº†è§£ç”¨æˆ·<code>user_id</code> å¯ä»¥åœ¨2019çš„1-2æœˆæœŸé—´é€šè¿‡é“¾æ¡å¤šè¿œã€‚</p><p>æŸ¥è¯¢:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        user_id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        windowFunnel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6048000000000000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1003</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1009</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1007</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1010</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> trend</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event_date </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2019-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event_date </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2019-02-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> user_id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ç»“æœ:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€levelâ”€â”¬â”€câ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚     4 â”‚ 1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="retention">Retention<a class="hash-link" href="#retention" title="Direct link to heading">â€‹</a></h2><p>è¯¥å‡½æ•°å°†ä¸€ç»„æ¡ä»¶ä½œä¸ºå‚æ•°ï¼Œç±»å‹ä¸º1åˆ°32ä¸ª <code>UInt8</code> ç±»å‹çš„å‚æ•°ï¼Œç”¨æ¥è¡¨ç¤ºäº‹ä»¶æ˜¯å¦æ»¡è¶³ç‰¹å®šæ¡ä»¶ã€‚
ä»»ä½•æ¡ä»¶éƒ½å¯ä»¥æŒ‡å®šä¸ºå‚æ•°ï¼ˆå¦‚ <a href="/zh/sql-reference/statements/select/where#select-where">WHERE</a>).</p><p>é™¤äº†ç¬¬ä¸€ä¸ªä»¥å¤–ï¼Œæ¡ä»¶æˆå¯¹é€‚ç”¨ï¼šå¦‚æœç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ˜¯çœŸçš„ï¼Œç¬¬äºŒä¸ªç»“æœå°†æ˜¯çœŸçš„ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜¯çœŸçš„ï¼Œç¬¬ä¸‰ä¸ªç»“æœå°†æ˜¯çœŸçš„ï¼Œç­‰ç­‰ã€‚</p><p><strong>è¯­æ³•</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">retention</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>å‚æ•°</strong></p><ul><li><code>cond</code> â€” è¿”å› <code>UInt8</code> ç»“æœï¼ˆ1æˆ–0ï¼‰çš„è¡¨è¾¾å¼ã€‚</li></ul><p><strong>è¿”å›å€¼</strong></p><p>æ•°ç»„ä¸º1æˆ–0ã€‚</p><ul><li>1 â€” æ¡ä»¶æ»¡è¶³ã€‚</li><li>0 â€” æ¡ä»¶ä¸æ»¡è¶³ã€‚</li></ul><p>ç±»å‹: <code>UInt8</code>.</p><p><strong>ç¤ºä¾‹</strong></p><p>è®©æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ <code>retention</code> åŠŸèƒ½çš„ä¸€ä¸ªä¾‹å­ ï¼Œä»¥ç¡®å®šç½‘ç«™æµé‡ã€‚</p><p><strong>1.</strong> ä¸¾ä¾‹è¯´æ˜ï¼Œå…ˆåˆ›å»ºä¸€å¼ è¡¨ã€‚</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> retention_test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Date</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> uid Int32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> retention_test </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> retention_test </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> retention_test </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>è¾“å…¥è¡¨:</p><p>æŸ¥è¯¢:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> retention_test</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ç»“æœ:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€dateâ”€â”¬â”€uidâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-01 â”‚   0 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-01 â”‚   1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-01 â”‚   2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-01 â”‚   3 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-01 â”‚   4 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€dateâ”€â”¬â”€uidâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   0 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   3 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   4 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   5 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   6 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   7 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   8 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-02 â”‚   9 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€dateâ”€â”¬â”€uidâ”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   0 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   1 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   2 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   3 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   4 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   5 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   6 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   7 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   8 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚   9 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚  10 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚  11 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚  12 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚  13 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚ 2020-01-03 â”‚  14 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>2.</strong> æŒ‰å”¯ä¸€ID <code>uid</code> å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç»„ï¼Œä½¿ç”¨ <code>retention</code> åŠŸèƒ½ã€‚</p><p>æŸ¥è¯¢:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    retention</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> retention_test</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> uid</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> uid </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ç»“æœ:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€uidâ”€â”¬â”€râ”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   0 â”‚ [1,1,1] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   1 â”‚ [1,1,1] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   2 â”‚ [1,1,1] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   3 â”‚ [1,1,1] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   4 â”‚ [1,1,1] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   5 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   6 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   7 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   8 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚   9 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  10 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  11 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  12 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  13 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  14 â”‚ [0,0,0] â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>3.</strong> è®¡ç®—æ¯å¤©çš„ç°åœºè®¿é—®æ€»æ•°ã€‚</p><p>æŸ¥è¯¢:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        uid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        retention</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> retention_test</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> uid</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ç»“æœ:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">â”Œâ”€r1â”€â”¬â”€r2â”€â”¬â”€r3â”€â”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â”‚  5 â”‚  5 â”‚  5 â”‚</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>æ¡ä»¶:</p><ul><li><code>r1</code>-2020-01-01æœŸé—´è®¿é—®è¯¥ç½‘ç«™çš„ç‹¬ç«‹è®¿é—®è€…æ•°é‡ï¼ˆ <code>cond1</code> æ¡ä»¶ï¼‰ã€‚</li><li><code>r2</code>-åœ¨2020-01-01å’Œ2020-01-02ä¹‹é—´çš„ç‰¹å®šæ—¶é—´æ®µå†…è®¿é—®è¯¥ç½‘ç«™çš„å”¯ä¸€è®¿é—®è€…çš„æ•°é‡ (<code>cond1</code> å’Œ <code>cond2</code> æ¡ä»¶ï¼‰ã€‚</li><li><code>r3</code>-åœ¨2020-01-01å’Œ2020-01-03ä¹‹é—´çš„ç‰¹å®šæ—¶é—´æ®µå†…è®¿é—®è¯¥ç½‘ç«™çš„å”¯ä¸€è®¿é—®è€…çš„æ•°é‡ (<code>cond1</code> å’Œ <code>cond3</code> æ¡ä»¶ï¼‰ã€‚</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="uniquptonx">uniqUpTo(N)(x)<a class="hash-link" href="#uniquptonx" title="Direct link to heading">â€‹</a></h2><p>è®¡ç®—å°äºæˆ–è€…ç­‰äºNçš„ä¸åŒå‚æ•°çš„ä¸ªæ•°ã€‚å¦‚æœç»“æœå¤§äºNï¼Œé‚£è¿”å›N+1ã€‚</p><p>å»ºè®®ä½¿ç”¨è¾ƒå°çš„Nsï¼Œæ¯”å¦‚ï¼š10ã€‚Nçš„æœ€å¤§å€¼ä¸º100ã€‚</p><p>å¯¹äºèšåˆå‡½æ•°çš„çŠ¶æ€ï¼Œå®ƒä½¿ç”¨çš„å†…å­˜é‡ç­‰äº1+N<!-- -->*<!-- -->ä¸€ä¸ªå­—èŠ‚å€¼çš„å¤§å°ã€‚
å¯¹äºå­—ç¬¦ä¸²ï¼Œå®ƒå­˜å‚¨8ä¸ªå­—èŠ‚çš„éåŠ å¯†å“ˆå¸Œã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè®¡ç®—æ˜¯è¿‘ä¼¼çš„å­—ç¬¦ä¸²ã€‚</p><p>è¯¥å‡½æ•°ä¹Ÿé€‚ç”¨äºå¤šä¸ªå‚æ•°ã€‚</p><p>å®ƒçš„å·¥ä½œé€Ÿåº¦å°½å¯èƒ½å¿«ï¼Œé™¤äº†ä½¿ç”¨è¾ƒå¤§çš„Nå€¼å¹¶ä¸”å”¯ä¸€å€¼çš„æ•°é‡ç•¥å°äºNçš„æƒ…å†µã€‚</p><p>ç”¨æ³•ç¤ºä¾‹:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">é—®é¢˜ï¼šäº§å‡ºä¸€ä¸ªä¸å°‘äºäº”ä¸ªå”¯ä¸€ç”¨æˆ·çš„å…³é”®å­—æŠ¥å‘Š</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">è§£å†³æ–¹æ¡ˆï¼š å†™group byæŸ¥è¯¢è¯­å¥ HAVING uniqUpTo(4)(UserID) &gt;= 5</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="summapfilteredkeys-to-keepkeys-values">sumMapFiltered(keys_to_keep)(keys, values)<a class="hash-link" href="#summapfilteredkeys-to-keepkeys-values" title="Direct link to heading">â€‹</a></h2><p>å’Œ <a href="/zh/sql-reference/aggregate-functions/reference/summap#agg_functions-summap">sumMap</a> åŸºæœ¬ä¸€è‡´ï¼Œ é™¤äº†ä¸€ä¸ªé”®æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ã€‚è¿™åœ¨ä½¿ç”¨é«˜åŸºæ•°keyæ—¶å°¤å…¶æœ‰ç”¨ã€‚</p><p><a href="https://clickhouse.com/docs/en/query_language/agg_functions/parametric_functions/" target="_blank" rel="noopener noreferrer">åŸå§‹æ–‡ç« </a> </p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ClickHouse/ClickHouse/tree/docs-staging/docs/zh/sql-reference/aggregate-functions/parametric-functions.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/sql-reference/aggregate-functions/combinators"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">èšåˆå‡½æ•°ç»„åˆå™¨</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/sql-reference/table-functions/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">è¡¨å‡½æ•°</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#histogram" class="table-of-contents__link toc-highlight">histogram</a></li><li><a href="#function-sequencematch" class="table-of-contents__link toc-highlight">sequenceMatch(pattern)(timestamp, cond1, cond2, â€¦)</a></li><li><a href="#function-sequencecount" class="table-of-contents__link toc-highlight">sequenceCount(pattern)(time, cond1, cond2, â€¦)</a></li><li><a href="#windowfunnel" class="table-of-contents__link toc-highlight">windowFunnel</a></li><li><a href="#retention" class="table-of-contents__link toc-highlight">Retention</a></li><li><a href="#uniquptonx" class="table-of-contents__link toc-highlight">uniqUpTo(N)(x)</a></li><li><a href="#summapfilteredkeys-to-keepkeys-values" class="table-of-contents__link toc-highlight">sumMapFiltered(keys_to_keep)(keys, values)</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ClickHouse</div><ul class="footer__items"><li class="footer__item"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Company</a></li><li class="footer__item"><a href="https://clickhouse.com/cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ClickHouse as a Service</a></li><li class="footer__item"><a href="https://clickhouse.com/careers/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers</a></li><li class="footer__item"><a href="https://clickhouse.com/learn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn ClickHouse</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ClickHouse/ClickHouse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://clickhouse.com/blog/en/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/clickhousedb/shared_invite/zt-rxm3rdrk-lIUmhLC3V8WTaL0TGxsOmg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Policies</div><ul class="footer__items"><li class="footer__item"><a href="https://clickhouse.com/legal/trademark-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trademark Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo.png" alt="ClickHouse Documentation" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/img/logo.png" alt="ClickHouse Documentation" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></div><div class="footer__copyright">Copyright &copy; 2016&ndash;2022 ClickHouse, Inc. ClickHouse Docs provided under the Creative Commons CC BY-NC-SA license. ClickHouse&reg; is a registered trademark of ClickHouse, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.db9e59e5.js"></script>
<script src="/assets/js/main.028d105f.js"></script>
</body>
</html>