<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-zh/operations/tips">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KF1LLRTQ5Q"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KF1LLRTQ5Q",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="ClickHouse Docs" href="/opensearch.xml">
<script src="./src/js/analytics.js"></script><title data-rh="true">ä½¿ç”¨å»ºè®® | ClickHouse Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://sturdy-adventure-06fed4eb.pages.github.io//zh/operations/tips"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ä½¿ç”¨å»ºè®® | ClickHouse Docs"><meta data-rh="true" name="description" content="usage-recommendations}"><meta data-rh="true" property="og:description" content="usage-recommendations}"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sturdy-adventure-06fed4eb.pages.github.io//zh/operations/tips"><link data-rh="true" rel="alternate" href="https://sturdy-adventure-06fed4eb.pages.github.io//zh/operations/tips" hreflang="en"><link data-rh="true" rel="alternate" href="https://sturdy-adventure-06fed4eb.pages.github.io//zh/operations/tips" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d094a63e.css">
<link rel="preload" href="/assets/js/runtime~main.db9e59e5.js" as="script">
<link rel="preload" href="/assets/js/main.028d105f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">ClickHouse</b></a><a class="navbar__item navbar__link" href="/en/intro">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Language</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/intro">English</a></li><li><a class="dropdown__link" href="/ru">Russian</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh">Chinese</a></li></ul></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD sidebarWithHideableNavbar_d0QC"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_YUvz"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--dark_oUvU"><b>ClickHouse</b></a><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/">ä»€ä¹ˆæ˜¯ClickHouseï¼Ÿ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/ç®€ä»‹">ç®€ä»‹</a><button aria-label="Toggle the collapsible sidebar category &#x27;ç®€ä»‹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/getting-started/">å¿«é€Ÿä¸Šæ‰‹</a><button aria-label="Toggle the collapsible sidebar category &#x27;å¿«é€Ÿä¸Šæ‰‹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/interfaces/">æ¥å£</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ¥å£&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/å¼•æ“">å¼•æ“</a><button aria-label="Toggle the collapsible sidebar category &#x27;å¼•æ“&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/sql-reference/">SQLå‚è€ƒ</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQLå‚è€ƒ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/guides/">ClickHouseæŒ‡å—</a><button aria-label="Toggle the collapsible sidebar category &#x27;ClickHouseæŒ‡å—&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/operations/">æ“ä½œ</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ“ä½œ&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/requirements">å¿…å¤‡æ¡ä»¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/monitoring">ç›‘æ§</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/troubleshooting">å¸¸è§é—®é¢˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/update">æ›´æ–°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/access-rights">è®¿é—®æƒé™å’Œè´¦æˆ·ç®¡ç†</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/operations/external-authenticators/">External User Authenticators and Directories</a><button aria-label="Toggle the collapsible sidebar category &#x27;External User Authenticators and Directories&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/backup">æ•°æ®å¤‡ä»½</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/operations/system-tables/">ç³»ç»Ÿè¡¨</a><button aria-label="Toggle the collapsible sidebar category &#x27;ç³»ç»Ÿè¡¨&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/performance-test">æµ‹è¯•ç¡¬ä»¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/opentelemetry">OpenTelemetry Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/caches">Caches</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/clickhouse-keeper">ClickHouse Keeper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/storing-data">External Disks for Storing Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/configuration-files">é…ç½®æ–‡ä»¶</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/zh/operations/optimizing-performance/sampling-query-profiler">optimizing-performance</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/operations/quotas">é…é¢</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/operations/server-configuration-parameters/">æœåŠ¡å™¨é…ç½®å‚æ•°</a><button aria-label="Toggle the collapsible sidebar category &#x27;æœåŠ¡å™¨é…ç½®å‚æ•°&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/operations/settings/">è®¾ç½®</a><button aria-label="Toggle the collapsible sidebar category &#x27;è®¾ç½®&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/operations/tips">ä½¿ç”¨å»ºè®®</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/operations/utilities/">å®ç”¨å·¥å…·</a><button aria-label="Toggle the collapsible sidebar category &#x27;å®ç”¨å·¥å…·&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/commercial/">å•†ä¸šæ”¯æŒ</a><button aria-label="Toggle the collapsible sidebar category &#x27;å•†ä¸šæ”¯æŒ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/faq/">F.A.Q.</a><button aria-label="Toggle the collapsible sidebar category &#x27;F.A.Q.&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/whats-new/">ClickHouseäº‹è¿¹</a><button aria-label="Toggle the collapsible sidebar category &#x27;ClickHouseäº‹è¿¹&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/changelog/">å˜æ›´æ—¥å¿—</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/development/">ClickHouse å¼€å‘</a><button aria-label="Toggle the collapsible sidebar category &#x27;ClickHouse å¼€å‘&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">ğŸ </a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/operations/"><span itemprop="name">æ“ä½œ</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">ä½¿ç”¨å»ºè®®</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ä½¿ç”¨å»ºè®®</h1><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cpu-scaling-governor">CPUé¢‘ç‡è°ƒèŠ‚å™¨<a class="hash-link" href="#cpu-scaling-governor" title="Direct link to heading">â€‹</a></h2><p>å§‹ç»ˆä½¿ç”¨ <code>performance</code> é¢‘ç‡è°ƒèŠ‚å™¨ã€‚  <code>on-demand</code> é¢‘ç‡è°ƒèŠ‚å™¨åœ¨æŒç»­é«˜éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œæ•ˆæœæ›´å·®ã€‚</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token builtin class-name" style="color:rgb(38, 127, 153)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;performance&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">tee</span><span class="token plain"> /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cpu-limitations">CPUé™åˆ¶<a class="hash-link" href="#cpu-limitations" title="Direct link to heading">â€‹</a></h2><p>å¤„ç†å™¨å¯èƒ½ä¼šè¿‡çƒ­ã€‚ ä½¿ç”¨ <code>dmesg</code> æŸ¥çœ‹CPUçš„æ—¶é’Ÿé€Ÿç‡æ˜¯å¦ç”±äºè¿‡çƒ­è€Œå—åˆ°é™åˆ¶ã€‚
è¯¥é™åˆ¶ä¹Ÿå¯ä»¥åœ¨æ•°æ®ä¸­å¿ƒçº§åˆ«å¤–éƒ¨è®¾ç½®ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ <code>turbostat</code> åœ¨è´Ÿè½½ä¸‹å¯¹å…¶è¿›è¡Œç›‘æ§ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ram">RAM<a class="hash-link" href="#ram" title="Direct link to heading">â€‹</a></h2><p>å¯¹äºå°‘é‡æ•°æ®ï¼ˆå‹ç¼©åçº¦200GBï¼‰ï¼Œæœ€å¥½ä½¿ç”¨ä¸æ•°æ®é‡ä¸€æ ·å¤šçš„å†…å­˜ã€‚
å¯¹äºå¤§é‡æ•°æ®ï¼Œä»¥åŠåœ¨å¤„ç†äº¤äº’å¼ï¼ˆåœ¨çº¿ï¼‰æŸ¥è¯¢æ—¶ï¼Œåº”ä½¿ç”¨åˆç†æ•°é‡çš„RAMï¼ˆ128GBæˆ–æ›´å¤šï¼‰ï¼Œä»¥ä¾¿çƒ­æ•°æ®å­é›†é€‚åˆé¡µé¢ç¼“å­˜ã€‚
å³ä½¿å¯¹äºæ¯å°æœåŠ¡å™¨çº¦50TBçš„æ•°æ®é‡ï¼Œä¸64GBç›¸æ¯”ï¼Œä½¿ç”¨128GBçš„RAMä¹Ÿå¯ä»¥æ˜¾ç€æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</p><p>ä¸è¦ç¦ç”¨ overcommitã€‚<code>cat /proc/sys/vm/overcommit_memory</code> çš„å€¼åº”è¯¥ä¸º0æˆ–1ã€‚è¿è¡Œ</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">echo</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">tee</span><span class="token plain"> /proc/sys/vm/overcommit_memory</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="huge-pages">å¤§é¡µ(Huge Pages)<a class="hash-link" href="#huge-pages" title="Direct link to heading">â€‹</a></h2><p>å§‹ç»ˆç¦ç”¨é€æ˜å¤§é¡µ(transparent huge pages)ã€‚ å®ƒä¼šå¹²æ‰°å†…å­˜åˆ†é…å™¨ï¼Œä»è€Œå¯¼è‡´æ˜¾ç€çš„æ€§èƒ½ä¸‹é™ã€‚</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token builtin class-name" style="color:rgb(38, 127, 153)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;never&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">tee</span><span class="token plain"> /sys/kernel/mm/transparent_hugepage/enabled</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ä½¿ç”¨ <code>perf top</code> æ¥æŸ¥çœ‹å†…æ ¸åœ¨å†…å­˜ç®¡ç†ä¸ŠèŠ±è´¹çš„æ—¶é—´ã€‚
æ°¸ä¹…å¤§é¡µ(permanent huge pages)ä¹Ÿä¸éœ€è¦è¢«åˆ†é…ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="storage-subsystem">å­˜å‚¨å­ç³»ç»Ÿ<a class="hash-link" href="#storage-subsystem" title="Direct link to heading">â€‹</a></h2><p>å¦‚æœæ‚¨çš„é¢„ç®—å…è®¸æ‚¨ä½¿ç”¨SSDï¼Œè¯·ä½¿ç”¨SSDã€‚
å¦‚æœæ²¡æœ‰ï¼Œè¯·ä½¿ç”¨ç¡¬ç›˜ã€‚ SATAç¡¬ç›˜7200è½¬å°±è¡Œäº†ã€‚</p><p>ä¼˜å…ˆé€‰æ‹©è®¸å¤šå¸¦æœ‰æœ¬åœ°ç¡¬ç›˜é©±åŠ¨å™¨çš„æœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯å°‘é‡å¸¦æœ‰é™„åŠ ç£ç›˜æ¶çš„æœåŠ¡å™¨ã€‚
ä½†æ˜¯å¯¹äºå­˜å‚¨æå°‘æŸ¥è¯¢çš„æ¡£æ¡ˆï¼Œæ¶å­å¯ä»¥ä½¿ç”¨ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="raid">RAID<a class="hash-link" href="#raid" title="Direct link to heading">â€‹</a></h2><p>å½“ä½¿ç”¨ç¡¬ç›˜ï¼Œä½ å¯ä»¥ç»“åˆä»–ä»¬çš„RAID-10ï¼ŒRAID-5ï¼ŒRAID-6æˆ–RAID-50ã€‚
å¯¹äºLinuxï¼Œè½¯ä»¶RAIDæ›´å¥½ï¼ˆä½¿ç”¨ <code>mdadm</code>). æˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨LVMã€‚
å½“åˆ›å»ºRAID-10ï¼Œé€‰æ‹© <code>far</code> å¸ƒå±€ã€‚
å¦‚æœæ‚¨çš„é¢„ç®—å…è®¸ï¼Œè¯·é€‰æ‹©RAID-10ã€‚</p><p>å¦‚æœæ‚¨æœ‰4ä¸ªä»¥ä¸Šçš„ç£ç›˜ï¼Œè¯·ä½¿ç”¨RAID-6ï¼ˆé¦–é€‰ï¼‰æˆ–RAID-50ï¼Œè€Œä¸æ˜¯RAID-5ã€‚
å½“ä½¿ç”¨RAID-5ã€RAID-6æˆ–RAID-50æ—¶ï¼Œå§‹ç»ˆå¢åŠ stripe_cache_sizeï¼Œå› ä¸ºé»˜è®¤å€¼é€šå¸¸ä¸æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token builtin class-name" style="color:rgb(38, 127, 153)">echo</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">tee</span><span class="token plain"> /sys/block/md2/md/stripe_cache_size</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ä½¿ç”¨ä»¥ä¸‹å…¬å¼ä»è®¾å¤‡æ•°é‡å’Œå—å¤§å°ä¸­è®¡ç®—å‡ºç¡®åˆ‡çš„æ•°é‡: <code>2 * num_devices * chunk_size_in_bytes / 4096</code>ã€‚</p><p>1024KBçš„å—å¤§å°è¶³ä»¥æ»¡è¶³æ‰€æœ‰RAIDé…ç½®ã€‚
åˆ‡å‹¿å°†å—å¤§å°è®¾ç½®å¾—å¤ªå°æˆ–å¤ªå¤§ã€‚</p><p>æ‚¨å¯ä»¥åœ¨SSDä¸Šä½¿ç”¨RAID-0ã€‚
æ— è®ºä½¿ç”¨å“ªç§RAIDï¼Œå§‹ç»ˆä½¿ç”¨å¤åˆ¶æ¥ä¿è¯æ•°æ®å®‰å…¨ã€‚</p><p>å¯ç”¨æœ‰é•¿é˜Ÿåˆ—çš„NCQã€‚ å¯¹äºHDDï¼Œé€‰æ‹©CFQè°ƒåº¦ç¨‹åºï¼Œå¯¹äºSSDï¼Œé€‰æ‹©noopã€‚ ä¸è¦å‡å°‘ â€˜readaheadâ€™ è®¾ç½®ã€‚
å¯¹äºHDDï¼Œå¯ç”¨å†™å…¥ç¼“å­˜ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="file-system">æ–‡ä»¶ç³»ç»Ÿ<a class="hash-link" href="#file-system" title="Direct link to heading">â€‹</a></h2><p>Ext4æ˜¯æœ€å¯é çš„é€‰æ‹©ã€‚ è®¾ç½®æŒ‚è½½é€‰é¡¹ <code>noatime</code>.
XFSä¹Ÿæ˜¯åˆé€‚çš„ï¼Œä½†å®ƒè¿˜æ²¡æœ‰ç»è¿‡ClickHouseçš„å…¨é¢æµ‹è¯•ã€‚
å¤§å¤šæ•°å…¶ä»–æ–‡ä»¶ç³»ç»Ÿä¹Ÿåº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ å…·æœ‰å»¶è¿Ÿåˆ†é…çš„æ–‡ä»¶ç³»ç»Ÿå·¥ä½œå¾—æ›´å¥½ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="linux-kernel">Linuxå†…æ ¸<a class="hash-link" href="#linux-kernel" title="Direct link to heading">â€‹</a></h2><p>ä¸è¦ä½¿ç”¨è¿‡æ—¶çš„Linuxå†…æ ¸ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="network">ç½‘ç»œ<a class="hash-link" href="#network" title="Direct link to heading">â€‹</a></h2><p>å¦‚æœä½¿ç”¨çš„æ˜¯IPv6ï¼Œè¯·å¢åŠ è·¯ç”±ç¼“å­˜çš„å¤§å°ã€‚
3.2ä¹‹å‰çš„Linuxå†…æ ¸åœ¨IPv6å®ç°æ–¹é¢å­˜åœ¨è®¸å¤šé—®é¢˜ã€‚</p><p>å¦‚æœå¯èƒ½çš„è¯ï¼Œè‡³å°‘ä½¿ç”¨10GBçš„ç½‘ç»œã€‚1GBä¹Ÿå¯ä»¥å·¥ä½œï¼Œä½†å¯¹äºä½¿ç”¨æ•°åTBçš„æ•°æ®ä¿®è¡¥å‰¯æœ¬æˆ–å¤„ç†å…·æœ‰å¤§é‡ä¸­é—´æ•°æ®çš„åˆ†å¸ƒå¼æŸ¥è¯¢ï¼Œæƒ…å†µä¼šæ›´ç³Ÿã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="è™šæ‹Ÿæœºç›‘è§†å™¨hypervisoré…ç½®">è™šæ‹Ÿæœºç›‘è§†å™¨(Hypervisor)é…ç½®<a class="hash-link" href="#è™šæ‹Ÿæœºç›‘è§†å™¨hypervisoré…ç½®" title="Direct link to heading">â€‹</a></h2><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯OpenStackï¼Œè¯·åœ¨nova.confä¸­è®¾ç½®</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">cpu_mode=host-passthrough</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ã€‚</p><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯libvirtï¼Œè¯·åœ¨XMLé…ç½®ä¸­è®¾ç½®</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">&lt;cpu mode=&#x27;host-passthrough&#x27;/&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ã€‚</p><p>è¿™å¯¹äºClickHouseèƒ½å¤Ÿé€šè¿‡ <code>cpuid</code> æŒ‡ä»¤è·å–æ­£ç¡®çš„ä¿¡æ¯éå¸¸é‡è¦ã€‚
å¦åˆ™ï¼Œå½“åœ¨æ—§çš„CPUå‹å·ä¸Šè¿è¡Œè™šæ‹Ÿæœºç›‘è§†å™¨æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ <code>Illegal instruction</code> å´©æºƒã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="zookeeper">Zookeeper<a class="hash-link" href="#zookeeper" title="Direct link to heading">â€‹</a></h2><p>æ‚¨å¯èƒ½å·²ç»å°†ZooKeeperç”¨äºå…¶ä»–ç›®çš„ã€‚ å¦‚æœå®ƒè¿˜æ²¡æœ‰è¶…è½½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„zookeeperã€‚</p><p>æœ€å¥½ä½¿ç”¨æ–°ç‰ˆæœ¬çš„Zookeeper â€“ 3.4.9 æˆ–æ›´é«˜çš„ç‰ˆæœ¬. ç¨³å®šçš„Liunxå‘è¡Œç‰ˆä¸­çš„Zookeeperç‰ˆæœ¬å¯èƒ½å·²è¿‡æ—¶ã€‚</p><p>ä½ æ°¸è¿œä¸è¦ä½¿ç”¨æ‰‹åŠ¨ç¼–å†™çš„è„šæœ¬åœ¨ä¸åŒçš„Zookeeperé›†ç¾¤ä¹‹é—´ä¼ è¾“æ•°æ®, è¿™å¯èƒ½ä¼šå¯¼è‡´åºåˆ—èŠ‚ç‚¹çš„æ•°æ®ä¸æ­£ç¡®ã€‚å‡ºäºç›¸åŒçš„åŸå› ï¼Œæ°¸è¿œä¸è¦ä½¿ç”¨ zkcopy å·¥å…·: <a href="https://github.com/ksprojects/zkcopy/issues/15" target="_blank" rel="noopener noreferrer">https://github.com/ksprojects/zkcopy/issues/15</a></p><p>å¦‚æœè¦å°†ç°æœ‰çš„ZooKeeperé›†ç¾¤åˆ†ä¸ºä¸¤ä¸ªï¼Œæ­£ç¡®çš„æ–¹æ³•æ˜¯å¢åŠ å…¶å‰¯æœ¬çš„æ•°é‡ï¼Œç„¶åå°†å…¶é‡æ–°é…ç½®ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„é›†ç¾¤ã€‚</p><p>ä¸è¦åœ¨ClickHouseæ‰€åœ¨çš„æœåŠ¡å™¨ä¸Šè¿è¡ŒZooKeeperã€‚ å› ä¸ºZooKeeperå¯¹å»¶è¿Ÿéå¸¸æ•æ„Ÿï¼Œè€ŒClickHouseå¯èƒ½ä¼šå ç”¨æ‰€æœ‰å¯ç”¨çš„ç³»ç»Ÿèµ„æºã€‚</p><p>é»˜è®¤è®¾ç½®ä¸‹ï¼ŒZooKeeper å°±åƒæ˜¯ä¸€ä¸ªå®šæ—¶ç‚¸å¼¹:</p><p>å½“ä½¿ç”¨é»˜è®¤é…ç½®æ—¶ï¼ŒZooKeeperæœåŠ¡å™¨ä¸ä¼šä»æ—§çš„å¿«ç…§å’Œæ—¥å¿—ä¸­åˆ é™¤æ–‡ä»¶ï¼ˆè¯·å‚é˜…autopurgeï¼‰ï¼Œè¿™æ˜¯æ“ä½œå‘˜çš„è´£ä»»ã€‚</p><p>å¿…é¡»æ‹†é™¤ç‚¸å¼¹ã€‚</p><p>ä¸‹é¢çš„ZooKeeperï¼ˆ3.5.1ï¼‰é…ç½®åœ¨ Yandex.Metrica çš„ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æˆªè‡³2017å¹´5æœˆ20æ—¥:</p><p>zoo.cfg:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># http://hadoop.apache.org/zookeeper/docs/current/zookeeperAdmin.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># The number of milliseconds of each tick</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">tickTime</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># The number of ticks that the initial</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># synchronization phase can take</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">initLimit</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">30000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># The number of ticks that can pass between</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># sending a request and getting an acknowledgement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">syncLimit</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">maxClientCnxns</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">maxSessionTimeout</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">60000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># the directory where the snapshot is stored.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">dataDir</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/opt/zookeeper/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;{{&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;name&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;}}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">/data</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Place the dataLogDir to a separate physical disc for better performance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">dataLogDir</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/opt/zookeeper/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;{{&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;name&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;}}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">/logs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">autopurge.snapRetainCount</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">autopurge.purgeInterval</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># To avoid seeks ZooKeeper allocates space in the transaction log file in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># blocks of preAllocSize kilobytes. The default block size is 64M. One reason</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># for changing the size of the blocks is to reduce the block size if snapshots</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># are taken more often. (Also, see snapCount).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">preAllocSize</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">131072</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Clients can submit requests faster than ZooKeeper can process them,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># especially if there are a lot of clients. To prevent ZooKeeper from running</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># out of memory due to queued requests, ZooKeeper will throttle clients so that</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># there is no more than globalOutstandingLimit outstanding requests in the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># system. The default limit is 1,000.ZooKeeper logs transactions to a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># transaction log. After snapCount transactions are written to a log file a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># snapshot is started and a new transaction log file is started. The default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># snapCount is 10,000.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">snapCount</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">3000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># If this option is defined, requests will be will logged to a trace file named</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># traceFile.year.month.day.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#traceFile=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Leader accepts client connections. Default value is &quot;yes&quot;. The leader machine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># coordinates updates. For higher update throughput at thes slight expense of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># read throughput the leader can be configured to not accept clients and focus</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># on coordination.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">leaderServes</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">standaloneEnabled</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">dynamicConfigFile</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/etc/zookeeper-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;{{&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;name&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;}}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">/conf/zoo.cfg.dynamic</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Javaç‰ˆæœ¬:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">Java(TM) SE Runtime Environment (build 1.8.0_25-b17)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Java HotSpot(TM) 64-Bit Server VM (build 25.25-b02, mixed mode)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>JVMå‚æ•°:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token assign-left variable" style="color:rgb(9, 134, 88)">NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">zookeeper-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;{{&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;name&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;}}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ZOOCFGDIR</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/etc/</span><span class="token variable" style="color:rgb(9, 134, 88)">$NAME</span><span class="token plain">/conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># TODO this is really ugly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># How to find out, which jars are needed?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># seems, that log4j requires the log4j.properties file to be in the classpath</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">CLASSPATH</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$ZOOCFGDIR</span><span class="token string" style="color:rgb(163, 21, 21)">:/usr/build/classes:/usr/build/lib/*.jar:/usr/share/zookeeper/zookeeper-3.5.1-metrika.jar:/usr/share/zookeeper/slf4j-log4j12-1.7.5.jar:/usr/share/zookeeper/slf4j-api-1.7.5.jar:/usr/share/zookeeper/servlet-api-2.5-20081211.jar:/usr/share/zookeeper/netty-3.7.0.Final.jar:/usr/share/zookeeper/log4j-1.2.16.jar:/usr/share/zookeeper/jline-2.11.jar:/usr/share/zookeeper/jetty-util-6.1.26.jar:/usr/share/zookeeper/jetty-6.1.26.jar:/usr/share/zookeeper/javacc.jar:/usr/share/zookeeper/jackson-mapper-asl-1.9.11.jar:/usr/share/zookeeper/jackson-core-asl-1.9.11.jar:/usr/share/zookeeper/commons-cli-1.2.jar:/usr/src/java/lib/*.jar:/usr/etc/zookeeper&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ZOOCFG</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$ZOOCFGDIR</span><span class="token string" style="color:rgb(163, 21, 21)">/zoo.cfg&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ZOO_LOG_DIR</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/var/log/</span><span class="token variable" style="color:rgb(9, 134, 88)">$NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable environment constant" style="color:rgb(129, 31, 63)">USER</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">GROUP</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PIDDIR</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/var/run/</span><span class="token variable" style="color:rgb(9, 134, 88)">$NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PIDFILE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token variable" style="color:rgb(9, 134, 88)">$PIDDIR</span><span class="token plain">/</span><span class="token variable" style="color:rgb(9, 134, 88)">$NAME</span><span class="token plain">.pid</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">SCRIPTNAME</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/etc/init.d/</span><span class="token variable" style="color:rgb(9, 134, 88)">$NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">JAVA</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">/usr/bin/java</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ZOOMAIN</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;org.apache.zookeeper.server.quorum.QuorumPeerMain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ZOO_LOG4J_PROP</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;INFO,ROLLINGFILE&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">JMXLOCALONLY</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">JAVA_OPTS</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-Xms{{ &#x27;{{&#x27; }} cluster.get(&#x27;xms&#x27;,&#x27;128M&#x27;) {{ &#x27;}}&#x27; }} \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -Xmx{{ &#x27;{{&#x27; }} cluster.get(&#x27;xmx&#x27;,&#x27;1G&#x27;) {{ &#x27;}}&#x27; }} \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -Xloggc:/var/log/</span><span class="token string variable" style="color:rgb(9, 134, 88)">$NAME</span><span class="token string" style="color:rgb(163, 21, 21)">/zookeeper-gc.log \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+UseGCLogFileRotation \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:NumberOfGCLogFiles=16 \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:GCLogFileSize=16M \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -verbose:gc \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintGCTimeStamps \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintGCDateStamps \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintGCDetails</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintTenuringDistribution \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintGCApplicationStoppedTime \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintGCApplicationConcurrentTime \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+PrintSafepointStatistics \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+UseParNewGC \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">    -XX:+UseConcMarkSweepGC \</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">-XX:+CMSParallelRemarkEnabled&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>åˆå§‹åŒ–:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">description &quot;zookeeper-{{ &#x27;{{&#x27; }} cluster[&#x27;name&#x27;] {{ &#x27;}}&#x27; }} centralized coordination service&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">start on runlevel [2345]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stop on runlevel [!2345]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">respawn</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">limit nofile 8192 8192</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pre-start script</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ -r &quot;/etc/zookeeper-{{ &#x27;{{&#x27; }} cluster[&#x27;name&#x27;] {{ &#x27;}}&#x27; }}/conf/environment&quot; ] || exit 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    . /etc/zookeeper-{{ &#x27;{{&#x27; }} cluster[&#x27;name&#x27;] {{ &#x27;}}&#x27; }}/conf/environment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ -d $ZOO_LOG_DIR ] || mkdir -p $ZOO_LOG_DIR</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    chown $USER:$GROUP $ZOO_LOG_DIR</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">end script</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">script</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    . /etc/zookeeper-{{ &#x27;{{&#x27; }} cluster[&#x27;name&#x27;] {{ &#x27;}}&#x27; }}/conf/environment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [ -r /etc/default/zookeeper ] &amp;&amp; . /etc/default/zookeeper</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    if [ -z &quot;$JMXDISABLE&quot; ]; then</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        JAVA_OPTS=&quot;$JAVA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=$JMXLOCALONLY&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    exec start-stop-daemon --start -c $USER --exec $JAVA --name zookeeper-{{ &#x27;{{&#x27; }} cluster[&#x27;name&#x27;] {{ &#x27;}}&#x27; }} \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        -- -cp $CLASSPATH $JAVA_OPTS -Dzookeeper.log.dir=${ZOO_LOG_DIR} \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        -Dzookeeper.root.logger=${ZOO_LOG4J_PROP} $ZOOMAIN $ZOOCFG</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">end script</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><a href="https://clickhouse.com/docs/en/operations/tips/" target="_blank" rel="noopener noreferrer">åŸå§‹æ–‡ç« </a> </p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ClickHouse/ClickHouse/tree/docs-staging/docs/zh/operations/tips.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/operations/settings/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">è®¾ç½®</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/operations/utilities/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å®ç”¨å·¥å…·</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cpu-scaling-governor" class="table-of-contents__link toc-highlight">CPUé¢‘ç‡è°ƒèŠ‚å™¨</a></li><li><a href="#cpu-limitations" class="table-of-contents__link toc-highlight">CPUé™åˆ¶</a></li><li><a href="#ram" class="table-of-contents__link toc-highlight">RAM</a></li><li><a href="#huge-pages" class="table-of-contents__link toc-highlight">å¤§é¡µ(Huge Pages)</a></li><li><a href="#storage-subsystem" class="table-of-contents__link toc-highlight">å­˜å‚¨å­ç³»ç»Ÿ</a></li><li><a href="#raid" class="table-of-contents__link toc-highlight">RAID</a></li><li><a href="#file-system" class="table-of-contents__link toc-highlight">æ–‡ä»¶ç³»ç»Ÿ</a></li><li><a href="#linux-kernel" class="table-of-contents__link toc-highlight">Linuxå†…æ ¸</a></li><li><a href="#network" class="table-of-contents__link toc-highlight">ç½‘ç»œ</a></li><li><a href="#è™šæ‹Ÿæœºç›‘è§†å™¨hypervisoré…ç½®" class="table-of-contents__link toc-highlight">è™šæ‹Ÿæœºç›‘è§†å™¨(Hypervisor)é…ç½®</a></li><li><a href="#zookeeper" class="table-of-contents__link toc-highlight">Zookeeper</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ClickHouse</div><ul class="footer__items"><li class="footer__item"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Company</a></li><li class="footer__item"><a href="https://clickhouse.com/cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ClickHouse as a Service</a></li><li class="footer__item"><a href="https://clickhouse.com/careers/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers</a></li><li class="footer__item"><a href="https://clickhouse.com/learn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn ClickHouse</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ClickHouse/ClickHouse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://clickhouse.com/blog/en/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/clickhousedb/shared_invite/zt-rxm3rdrk-lIUmhLC3V8WTaL0TGxsOmg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Policies</div><ul class="footer__items"><li class="footer__item"><a href="https://clickhouse.com/legal/trademark-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trademark Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo.png" alt="ClickHouse Documentation" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/img/logo.png" alt="ClickHouse Documentation" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></div><div class="footer__copyright">Copyright &copy; 2016&ndash;2022 ClickHouse, Inc. ClickHouse Docs provided under the Creative Commons CC BY-NC-SA license. ClickHouse&reg; is a registered trademark of ClickHouse, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.db9e59e5.js"></script>
<script src="/assets/js/main.028d105f.js"></script>
</body>
</html>